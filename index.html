<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DHS “Worst of the Worst” – USA Map (2024)</title>
<style>
  body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4}
  h1{margin:0;padding:14px;background:#111;color:#fff;text-align:center}
  .map{max-width:1200px;margin:12px auto;background:#fff;padding:10px;border-radius:8px}
  svg{width:100%;height:auto;display:block}
  .state-shape{stroke:#fff;stroke-width:1;cursor:pointer}
  .state-shape:hover{filter:brightness(1.08)}
</style>
</head>
<body>
<h1>DHS “Worst of the Worst” – USA Map (2024)</h1>
<div class="map" id="map"></div>

<script>
const RED = new Set([
  "AL","AK","AR","FL","ID","IN","IA","KS","KY","LA","MO","MS","MT","ND",
  "NE","OH","OK","SC","SD","TN","TX","UT","WV","WY"
]);

const BLUE = new Set([
  "AZ","CA","CO","CT","DE","GA","HI","IL","ME","MD","MA","MI","MN","NV",
  "NH","NJ","NM","NY","NC","OR","PA","RI","VT","VA","WA","WI","DC"
]);

const STATE_NAME = {
  AL:"Alabama", AK:"Alaska", AZ:"Arizona", AR:"Arkansas", CA:"California",
  CO:"Colorado", CT:"Connecticut", DE:"Delaware", FL:"Florida", GA:"Georgia",
  HI:"Hawaii", ID:"Idaho", IL:"Illinois", IN:"Indiana", IA:"Iowa",
  KS:"Kansas", KY:"Kentucky", LA:"Louisiana", ME:"Maine", MD:"Maryland",
  MA:"Massachusetts", MI:"Michigan", MN:"Minnesota", MS:"Mississippi", MO:"Missouri",
  MT:"Montana", NE:"Nebraska", NV:"Nevada", NH:"New Hampshire", NJ:"New Jersey",
  NM:"New Mexico", NY:"New York", NC:"North Carolina", ND:"North Dakota", OH:"Ohio",
  OK:"Oklahoma", OR:"Oregon", PA:"Pennsylvania", RI:"Rhode Island", SC:"South Carolina",
  SD:"South Dakota", TN:"Tennessee", TX:"Texas", UT:"Utah", VT:"Vermont",
  VA:"Virginia", WA:"Washington", WV:"West Virginia", WI:"Wisconsin", WY:"Wyoming",
  DC:"District of Columbia"
};

const DHS_BASE =
  "https://www.dhs.gov/wow?combine=&field_country_of_origin_target_id=All&field_state_value=";

function colorFor(code){
  if (RED.has(code)) return "#b22234";     // Republican red
  if (BLUE.has(code)) return "#3c3b6e";    // Democrat blue
  return "#d0d0d0";                        // neutral
}

fetch("./us-states.svg")
  .then(r => r.text())
  .then(svgText => {
    document.getElementById("map").innerHTML = svgText;

    // Try common state selectors: paths, polygons, etc.
    const svg = document.querySelector("#map svg");
    const elems = svg.querySelectorAll("[id]");

    elems.forEach(el => {
      const code = (el.id || "").toUpperCase().trim();
      if (!STATE_NAME[code]) return;

      el.classList.add("state-shape");
      el.style.fill = colorFor(code);

      el.addEventListener("click", () => {
        const stateName = STATE_NAME[code];
        window.open(DHS_BASE + encodeURIComponent(stateName), "_blank", "noopener");
      });
    });
  })
  .catch(err => {
    document.getElementById("map").innerHTML =
      "<p style='padding:12px;color:#b00'>Could not load us-states.svg. Make sure it is uploaded to the repo root as <b>us-states.svg</b>.</p>";
  });
</script>
</body>
</html>
