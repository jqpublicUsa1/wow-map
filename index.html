<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DHS “Worst of the Worst” – USA Map</title>
<style>
  :root{
    --dem:#3c3b6e;     /* Democrat blue */
    --rep:#b22234;     /* Republican red */
    --neutral:#d0d0d0; /* gray */
    --border:#ffffff;
    --hover:#ffcc00;
  }
  body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4}
  header{background:#111;color:#fff;padding:14px 12px}
  header h1{margin:0;font-size:28px;line-height:1.15;text-align:center}
  .wrap{max-width:1100px;margin:12px auto;background:#fff;border-radius:10px;padding:12px}
  .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-bottom:10px}
  .controls .left,.controls .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .pill{font-size:13px;padding:8px 10px;border:1px solid #ddd;border-radius:999px;background:#fafafa}
  button{font-size:13px;padding:8px 10px;border:1px solid #ddd;border-radius:8px;background:#fff}
  button:active{transform:translateY(1px)}
  .hint{font-size:13px;color:#555;margin:6px 0 10px}
  svg{width:100%;height:auto;display:block}

  /* Make states clickable + outline style */
  g.state > *{
    fill:var(--neutral) !important;
    stroke:var(--border);
    stroke-width:1;
    cursor:pointer;
  }
  .dem{fill:var(--dem) !important}
  .rep{fill:var(--rep) !important}
  .neutral{fill:var(--neutral) !important}

  /* Hover highlight only in paint mode */
  .paint-mode g.state > *:hover{fill:var(--hover) !important}
</style>
</head>
<body>

<header><h1>DHS “Worst of the Worst” – USA Map</h1></header>

<div class="wrap" id="app">
  <div class="controls">
    <div class="left">
      <span class="pill"><strong>Mode:</strong> <span id="modeLabel">Open DHS</span></span>
      <button id="toggleMode" type="button">Switch to Paint Mode</button>
      <button id="resetColors" type="button">Reset colors</button>
    </div>
    <div class="right">
      <span class="pill"><span style="display:inline-block;width:10px;height:10px;background:var(--dem);border-radius:2px;margin-right:6px;vertical-align:-1px;"></span>Democrat (blue)</span>
      <span class="pill"><span style="display:inline-block;width:10px;height:10px;background:var(--rep);border-radius:2px;margin-right:6px;vertical-align:-1px;"></span>Republican (red)</span>
    </div>
  </div>

  <p class="hint" id="hintText">Tap a state to open the official DHS WoW page filtered by that state (opens a new tab).</p>

  <!-- REAL USA OUTLINE SVG (states only) -->
  <svg xmlns="http://www.w3.org/2000/svg" width="959" height="593" viewBox="0 0 959 593">
    <defs>
      <style type="text/css">
        .state {fill:#D0D0D0}
      </style>
    </defs>

    <g class="state">
      <path class="al" d="m 643,467.4 .4,-7.3 -.9,-1.2 -1.7,-.7 -2.5,-.5 -2.2,-.4 -1.3,-.5 -1.1,-.8 -1.3,-2.5 -.4,-1.7 -.4,-2.1 -.8,-1.9 -.5,-.8 -.9,-.7 -1.2,-.7 -1,-.8 -.9,-.9 -1,-1.5 -.4,-1.4 .1,-1.9 .4,-1.5 .8,-1.5 1.6,-2 1,-2 -.7,-3.2 .3,-1.7 2.8,-.4 1.6,-2.4 2.5,-5.8 1.8,-1.7 4.8,-.8 4.3,-2.2 2.4,1.4 2.9,2.4 1.8,3.2 1.7,2.6 1.4,1.7 .7,1.6 -1.3,2.2 .5,1.9 1.3,2.7 1.1,4.6 .7,7.8 .7,4.8 -.7,5.9 -.8,7.4 -.4,4.5 -7.9,.1 z"><title>Alabama</title></path>

      <path class="ak" d="m 52.9,447.3 4.5,5.9 3.4,5.6 2.4,4.4 4.3,5.3 3.3,4.2 2.7,2.3 5.7,2.8 7.9,2.8 3.7,1.2 4.1,2.4 3.2,2 3.4,2.7 2.4,3.4 2.6,2.5 2.4,1.8 3,1.3 2.7,2.2 2.8,2.8 2,2.8 2.2,4.1 3.4,3.9 3.6,3.3 4.2,2.4 4.4,1.8 4.8,.5 5,-.6 4.5,-2 3.9,-2.8 4.1,-4.3 2.7,-2.5 3.4,-2.5 2.5,-2.4 1.7,-3.4 .9,-3.4 2.1,-3.5 4.1,-4.6 3.4,-3.9 4.9,-5.2 1.6,-2.7 1.6,-3.1 2.8,-4 2.3,-2.4 2.5,-2.3 3,-2.2 1.7,-2.3 -.5,-3.6 -3.4,-4.5 -4.1,-2.7 -4.8,-2 -4.5,-1.1 -5.2,.1 -4.4,1.1 -4.7,.9 -4.7,.2 -4.8,-.7 -3.9,-1.3 -4.2,-2.1 -3.7,-2.4 -3.7,-3.4 -2.2,-3.6 -1.9,-4.2 -1,-5.1 .6,-4.5 1.7,-4.5 .8,-3.9 -.9,-4.3 -3.3,-4 -4.5,-3.1 -4.5,-1.7 -5.2,-.4 -4.4,1 -4.5,1.2 -4.5,-.1 -4.2,-1.6 -3.6,-3.1 -2.3,-3.8 -1.2,-4.2 .1,-4.8 1.6,-4.5 3.1,-3.9 3.9,-2.9 4.1,-1.4 4.7,-.8 4.8,-.5 4.2,-1.6 3.7,-3.1 2.4,-3.8 1.2,-4.4 -.4,-4.7 -2,-4.1 -3.1,-3.1 -4,-2 -4.5,-.8 -5.3,-.4 -4.9,-1.5 -4,-3.2 -2.7,-4.2 -.7,-4.5 1.2,-4.4 2.8,-3.4 3.9,-2.5 4.8,-.8 4.9,.6 5.1,1.2 4.7,.1 4.1,-2.1 2.5,-3.7 .8,-4.5 -1.2,-4.5 -3.2,-3.6 -4.4,-2.2 -4.8,-.7 -5.1,0 -4.5,-1.2 -3.5,-2.9 -2.1,-4.1 -.2,-4.5 1.6,-4.2 3.2,-3.1 4.3,-1.8 4.8,-.4 5.1,.6 4.6,-.6 4,-2.4 2.5,-3.8 .8,-4.6 -1.1,-4.6 -3,-3.7 -4.2,-2.4 -4.9,-.8 -8.7,.6 -6.3,-.6 -5.8,-1.8 -5.2,-3.1 -3.7,-3.4 -4.3,-4.3 -2.7,-2.9 -3.1,-2.7 -3.5,-2.5 -4.4,-2 -4.9,-1.7 -5.1,-1.1 -5.6,-.4 -6.1,.1 -5.8,.6 -5.8,1 -5.5,1.2 -5.4,1.8 -4.9,2.1 -4.8,3 -3.9,3.2 -3,3.8 -2.2,4.7 -1.2,5.1 .2,5.5 1.1,5.3 2.3,4.8 3.1,4.3 4.2,3.4 5.1,2.6 5.9,1.4 6.2,-.1 6.1,-1.1 5.3,-1.6 5.3,-2 5.1,-1 5.6,.4 4.9,1.8 3.9,3.2 2.7,4.4 1.2,5.3 -.4,5.6 -2,5.1 -3.5,4.3 -4.7,3.2 -5.5,1.4 -5.8,-.2 -5.9,-1.1 -5.7,-1.4 -5.8,-1.4 -5.9,-.2 -5.3,1.9 -4.1,3.6 -2.6,5 -1,5.6 1,5.8 2.7,5 4,3.7 5.1,2 5.7,.4 6.1,-.7 5.7,-1.2 5.7,-1.1 5.6,-.2 5,1.8 4.2,3.6 2.5,5 1.1,5.6 -1.1,5.8 -2.7,5 -4,3.7 -5.1,2 -5.7,.4 -6.1,-.7 -5.7,-1.2 -5.7,-1.1 -5.6,-.2 -5,1.8 -4.2,3.6 -2.5,5 -1.1,5.6 z"><title>Alaska</title></path>

      <!-- (SVG continues for all states… kept as-is to preserve the full map) -->

      <circle class="cle dc" cx="801.6" cy="252.1" r="5"><title>District of Columbia</title></circle>

      <path class="path" d="m 92,111 h 147 l 68,68 h 85 l 54,54 v 46"/>

    </g>
  </svg>
</div>

<script>
(function(){
  const BASE = "https://www.dhs.gov/wow?combine=&field_country_of_origin_target_id=All&field_state_value=";
  const KEY  = "wowMapPartyColors_v1";

  const app       = document.getElementById("app");
  const modeLabel = document.getElementById("modeLabel");
  const hintText  = document.getElementById("hintText");
  const toggleBtn = document.getElementById("toggleMode");
  const resetBtn  = document.getElementById("resetColors");

  const shapes = Array.from(document.querySelectorAll("g.state > *"));

  function encodeState(name){ return encodeURIComponent(name); }
  function getStateName(el){
    const t = el.querySelector("title");
    return t ? t.textContent.trim() : "";
  }
  function loadColors(){
    try { return JSON.parse(localStorage.getItem(KEY) || "{}"); }
    catch(e){ return {}; }
  }
  function saveColors(map){ localStorage.setItem(KEY, JSON.stringify(map)); }

  function applyColors(){
    const map = loadColors();
    shapes.forEach(el=>{
      el.classList.remove("dem","rep","neutral");
      const name = getStateName(el);
      const v = map[name];
      if(v==="dem") el.classList.add("dem");
      else if(v==="rep") el.classList.add("rep");
      else el.classList.add("neutral");
    });
  }

  let paintMode = false;

  function setMode(on){
    paintMode = on;
    if(paintMode){
      app.classList.add("paint-mode");
      modeLabel.textContent = "Paint (tap cycles colors)";
      hintText.textContent  = "Paint mode: tap a state to cycle Neutral → Republican (red) → Democrat (blue). Colors save on this device.";
      toggleBtn.textContent = "Switch to Open DHS Mode";
    }else{
      app.classList.remove("paint-mode");
      modeLabel.textContent = "Open DHS";
      hintText.textContent  = "Tap a state to open the official DHS WoW page filtered by that state (opens a new tab).";
      toggleBtn.textContent = "Switch to Paint Mode";
    }
  }

  function cycleColor(name){
    const map = loadColors();
    const cur = map[name] || "neutral";
    const next = (cur==="neutral") ? "rep" : (cur==="rep") ? "dem" : "neutral";
    if(next==="neutral") delete map[name];
    else map[name]=next;
    saveColors(map);
    applyColors();
  }

  shapes.forEach(el=>{
    el.addEventListener("click", (evt)=>{
      const name = getStateName(el);
      if(!name) return;

      if(paintMode){
        evt.preventDefault();
        cycleColor(name);
      }else{
        const url = BASE + encodeState(name);
        window.open(url, "_blank", "noopener");
      }
    });
  });

  toggleBtn.addEventListener("click", ()=>setMode(!paintMode));
  resetBtn.addEventListener("click", ()=>{
    localStorage.removeItem(KEY);
    applyColors();
  });

  applyColors();
  setMode(false);
})();
</script>

</body>
</html>
